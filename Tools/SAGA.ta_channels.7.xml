<tool name="SAGA.ta_channels.7" id="saga_ta_channels_7" version="1.0.0">
  <description>Valley Depth</description>
  <requirements>
    <requirement version="3.9" type="package">python</requirement>
  </requirements>
  <version_command><![CDATA[interpreter filename.exe --version]]></version_command>
  <command><![CDATA[$__tool_directory__/Code/openapi.py isArrayELEVATION False  output_data_VALLEY_DEPTH $output_data_VALLEY_DEPTH  output_data_RIDGE_LEVEL $output_data_RIDGE_LEVEL  name SAGA.ta_channels.7 ELEVATION $ELEVATION
THRESHOLD $THRESHOLD
MAXITER $MAXITER
NOUNDERGROUND $NOUNDERGROUND
ORDER $ORDER
prefer $prefer
response $response
outputType_VALLEY_DEPTH $OutputSection_VALLEY_DEPTH.outputType_VALLEY_DEPTH
transmissionMode_VALLEY_DEPTH $OutputSection_VALLEY_DEPTH.transmissionMode_VALLEY_DEPTH
outputType_RIDGE_LEVEL $OutputSection_RIDGE_LEVEL.outputType_RIDGE_LEVEL
transmissionMode_RIDGE_LEVEL $OutputSection_RIDGE_LEVEL.transmissionMode_RIDGE_LEVEL]]></command>
  <inputs>
    <param name="ELEVATION" type="data" optional="false" label="Elevation" help="Elevation The following data types are allowed in the txt file:  png, x-ogc-aaigrid, tiff, x-ogc-envi" format="txt"/>
    <param name="THRESHOLD" type="float" value="1" optional="true" label="Tension Threshold" help="Maximum change in elevation units (e.g. meter), iteration is stopped once maximum change reaches this threshold."/>
    <param name="MAXITER" type="integer" value="0" optional="true" label="Maximum Iterations" help="Maximum number of iterations, ignored if set to zero"/>
    <param name="NOUNDERGROUND" type="select" optional="true" label="Keep Ridge Level above Surface" help="Keep Ridge Level above Surface">
      <option selected="true" value="false">false</option>
      <option value="true">true</option>
    </param>
    <param name="ORDER" type="integer" value="4" optional="true" label="Ridge Detection Threshold" help="Ridge Detection Threshold"/>
    <param name="prefer" type="select" label="Choose the Prefer">
      <option selected="true" value="respond-async;return=representation">respond-async;return=representation</option>
      <option value="return=minimal">return=minimal</option>
      <option value="return=representation">return=representation</option>
    </param>
    <param name="response" type="select" label="Response Type" help="Choose 'raw' for raw data or 'document' for document data.">
      <option selected="true" value="document">document</option>
      <option value="raw">raw</option>
    </param>
    <section name="OutputSection_VALLEY_DEPTH" title="Select the appropriate transmission mode for the output format" expanded="true">
      <param name="outputType_VALLEY_DEPTH" type="select" label="Valley Depth" help="Valley Depth">
        <option value="application/x-ogc-aaigrid">x-ogc-aaigrid</option>
        <option value="application/x-ogc-envi">x-ogc-envi</option>
        <option value="image/png">png</option>
        <option value="image/tiff">tiff</option>
      </param>
      <param name="transmissionMode_VALLEY_DEPTH" type="select" label="Choose the transmission mode">
        <option selected="true" value="reference">reference</option>
        <option value="value">value</option>
      </param>
    </section>
    <section name="OutputSection_RIDGE_LEVEL" title="Select the appropriate transmission mode for the output format" expanded="true">
      <param name="outputType_RIDGE_LEVEL" type="select" label="Ridge Level" help="Ridge Level">
        <option value="application/x-ogc-aaigrid">x-ogc-aaigrid</option>
        <option value="application/x-ogc-envi">x-ogc-envi</option>
        <option value="image/png">png</option>
        <option value="image/tiff">tiff</option>
      </param>
      <param name="transmissionMode_RIDGE_LEVEL" type="select" label="Choose the transmission mode">
        <option selected="true" value="reference">reference</option>
        <option value="value">value</option>
      </param>
    </section>
  </inputs>
  <outputs>
    <data name="output_data_VALLEY_DEPTH" format="tiff" hidden="false">
      <change_format>
        <when input="response" format="txt" value="document"/>
        <when input="outputType_VALLEY_DEPTH" format="x-ogc-envi" value="application/x-ogc-envi"/>
        <when input="outputType_VALLEY_DEPTH" format="x-ogc-aaigrid" value="application/x-ogc-aaigrid"/>
        <when input="outputType_VALLEY_DEPTH" format="png" value="image/png"/>
      </change_format>
    </data>
    <data name="output_data_RIDGE_LEVEL" format="tiff" hidden="false">
      <change_format>
        <when input="response" format="txt" value="document"/>
        <when input="outputType_RIDGE_LEVEL" format="x-ogc-envi" value="application/x-ogc-envi"/>
        <when input="outputType_RIDGE_LEVEL" format="x-ogc-aaigrid" value="application/x-ogc-aaigrid"/>
        <when input="outputType_RIDGE_LEVEL" format="png" value="image/png"/>
      </change_format>
    </data>
  </outputs>
  <tests>
    <test>
      <output name="output_data" value="txt"/>
      <param name="response" value="document"/>
    </test>
  </tests>
  <help><![CDATA[Valley depth is calculated as difference between the elevation and an interpolated ridge level. Ridge level interpolation uses the algorithm implemented in the 'Vertical Distance to Channel Network' tool. It performs the following steps:&lt;br/&gt; - Definition of ridge cells (using Strahler order on the inverted DEM).&lt;br/&gt; - Interpolation of the ridge level.&lt;br/&gt; - Subtraction of the original elevations from the ridge level.&lt;br/&gt;]]></help>
  <citations>
    <citation type="bibtex">Josh</citation>
  </citations>
</tool>
